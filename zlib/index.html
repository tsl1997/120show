<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Z-Library 账号共享</title>
    <style>
        /* 基础重置 */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: #f0f2f5;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #1d1d1f;
            padding: 20px;
        }

        /* 核心大卡片 - 增加宽度 */
        .card {
            background: #ffffff;
            width: 100%;
            max-width: 600px;
            padding: 50px 40px;
            border-radius: 32px;
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.08);
            text-align: center;
            transition: transform 0.3s ease;
        }

        h1 { font-size: 28px; font-weight: 700; margin-bottom: 40px; letter-spacing: -0.5px; }

        /* 内容区域 - 字体加大 */
        .field-group { text-align: left; margin-bottom: 25px; }
        .label { 
            font-size: 13px; font-weight: 600; color: #86868b; 
            margin-bottom: 10px; margin-left: 5px; display: block;
        }

        .display-box {
            background: #f5f5f7;
            border-radius: 20px;
            padding: 20px 25px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 2px solid transparent;
            transition: all 0.2s;
        }
        .display-box:hover { background: #fff; border-color: #0071e3; }

        .value-text { 
            font-size: 24px; /* 字体加大 */
            font-weight: 700; 
            word-break: break-all; 
            color: #000;
            font-family: 'SF Mono', SFMono-Regular, ui-monospace, monospace;
        }

        /* 按钮设计 */
        .btn { border: none; cursor: pointer; transition: all 0.2s; font-family: inherit; }
        
        .copy-btn { 
            background: #0071e3; color: white; padding: 10px 18px; 
            border-radius: 12px; font-size: 14px; font-weight: 600;
            margin-left: 15px; flex-shrink: 0;
        }
        .copy-btn:hover { background: #0077ed; transform: scale(1.05); }

        .main-btns { display: flex; gap: 15px; margin-top: 35px; }
        
        .next-btn { 
            flex: 2; background: #1d1d1f; color: white; padding: 20px; 
            border-radius: 18px; font-size: 18px; font-weight: 600; 
        }
        .next-btn:hover { background: #000; transform: translateY(-2px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        
        .history-btn { 
            flex: 1; background: #e8e8ed; color: #1d1d1f; padding: 20px; 
            border-radius: 18px; font-size: 18px; font-weight: 600;
        }
        .history-btn:hover { background: #d2d2d7; }

        /* 提示语 - 变小变淡 */
        .usage-tip { font-size: 12px; color: #86868b; margin-top: 25px; line-height: 1.5; }
        .visit-link { display: inline-block; margin-top: 15px; color: #0071e3; text-decoration: none; font-size: 14px; font-weight: 500; }

        /* 页脚 */
        .footer { margin-top: 40px; font-size: 13px; color: #86868b; }
        .footer a { color: #515154; text-decoration: none; font-weight: 600; border-bottom: 1px solid #d2d2d7; padding-bottom: 2px; }

        /* 弹窗设计 */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(8px);
            display: none; align-items: center; justify-content: center; z-index: 100;
        }
        .modal {
            background: white; width: 95%; max-width: 550px; border-radius: 28px;
            padding: 30px; max-height: 80vh; display: flex; flex-direction: column;
            box-shadow: 0 30px 60px rgba(0,0,0,0.2);
        }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; border-bottom: 1px solid #f5f5f7; padding-bottom: 15px; }
        .close-modal { font-size: 28px; cursor: pointer; color: #86868b; padding: 0 10px; }
        
        /* 历史列表项优化 */
        .history-list { overflow-y: auto; flex: 1; border-radius: 12px; }
        .history-item { 
            padding: 18px; border-bottom: 1px solid #f0f0f2; font-size: 14px;
            display: grid; grid-template-columns: 1fr 1fr auto; align-items: center; gap: 15px;
            transition: background 0.2s;
        }
        .history-item:nth-child(even) { background-color: #fcfcfd; }
        .history-item:hover { background-color: #f5f5f7; }
        .history-item:last-child { border-bottom: none; }
        .time-tag { color: #aeaeb2; font-size: 11px; font-family: monospace; }

        /* 分页 */
        .pagination { display: flex; justify-content: center; gap: 20px; margin-top: 25px; align-items: center; padding-top: 15px; border-top: 1px solid #f5f5f7; }
        .page-btn { padding: 8px 16px; background: #f5f5f7; border-radius: 10px; font-size: 13px; font-weight: 600; color: #0071e3; }
        .page-btn:disabled { color: #d2d2d7; cursor: not-allowed; }

        .toast {
            position: fixed; bottom: 40px; background: #1d1d1f; color: white;
            padding: 12px 24px; border-radius: 15px; font-size: 14px; font-weight: 500;
            opacity: 0; transition: opacity 0.3s; z-index: 200; pointer-events: none;
        }
    </style>
</head>
<body>

    <div class="card">
        <h1>Z-Library 共享中心</h1>

        <div class="field-group">
            <span class="label">账号 (EMAIL)</span>
            <div class="display-box">
                <span id="email-val" class="value-text">准备就绪</span>
                <button class="copy-btn btn" onclick="copyText('email-val')">复制</button>
            </div>
        </div>

        <div class="field-group">
            <span class="label">密码 (PASSWORD)</span>
            <div class="display-box">
                <span id="pwd-val" class="value-text">******</span>
                <button class="copy-btn btn" onclick="copyText('pwd-val')">复制</button>
            </div>
        </div>

        <div class="main-btns">
            <button class="next-btn btn" onclick="handleNext()">换一个账号</button>
            <button class="history-btn btn" onclick="openHistory()">查看历史</button>
        </div>
        
        <div class="usage-tip">
            温馨提示：每个账号每日可下载10本数据。<br>
            如果额度用完，请点击上方“换一个”按钮尝试其他账号。
        </div>

        <a href="https://zh.z-library.sk/" target="_blank" class="visit-link">前往 Z-Library 官方网站 →</a>
    </div>

    <!-- 页脚署名 -->
    <div class="footer">
        本作品由 <a href="https://x.com/btc_xs" target="_blank">XS</a> 制作
    </div>

    <!-- 历史记录弹窗 -->
    <div id="modalOverlay" class="modal-overlay" onclick="closeHistory(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 style="font-size: 20px;">今日获取历史</h3>
                <span class="close-modal" onclick="closeHistory()">&times;</span>
            </div>
            <div id="historyList" class="history-list">
                <!-- 动态生成 -->
            </div>
            <div id="pagination" class="pagination">
                <!-- 分页 -->
            </div>
        </div>
    </div>

    <div id="toast" class="toast">复制成功</div>

    <script>
        // 数据源
        const ACCOUNTS_DATA = `sviprr@163.com===wedad231ass
b_love@126.com===edasdas122dsd
banruoqing@163.com===pkdsa754ssdfsdf
raoruoqing@163.com===bfbsdfs94523szd
mayun_taobao@163.com===feefsfsf6433fd
begggg@163.com===andcwqe2177yfv
xuanruoqing@163.com===jswd13cxf24ew
kongruoqing@163.com===m2sdssd213
kuangruoqing@163.com===y2mdsnq3ld
renruoqing@163.com===88dsasdsad33
x_love@163.com===xxx888abc
puruoqing@163.com===wewd123243
r_love@126.com===tggs13434dxzd
taoruoqing@163.com===554dsdsdq3
jianruoqing@163.com===55ffgsfds22
kuiruoqing@163.com===123dfdfwr3
boss6b@163.com===535dfsfs232
chengruoqing@163.com===crq123crq666
tutulove@126.com===tt520love
didilove@126.com===dd520love
zhengruoqing@163.com===zrq666vip
b_kiss@163.com===bkissb520
beiruoqing@163.com===brq520brq
love_i@126.com===loveloveme
vip_pp@163.com===vipppvippp
nieruoqing@163.com===nrz520nrq
wengruoqing@163.com===weng520
bchhhh@163.com===bch666bch888
g_love@163.com===gglove520
eosaaa@163.com===eoseos444
love_r@163.com===loverrr520
houruoqing@163.com===hong888
becccc@163.com===ccc888666
turuoqing@163.com===tu520tu
quruoqing@163.com===ququ520
peiruoqing@163.com===peipei520
zhuangruoqing@163.com===zhuang520
ganruoqing@163.com===gangan666
furuoqing@163.com===fufu888
idaodu@163.com===daodu888`.split('\n').filter(line => line.includes('===')).map(line => {
            const [email, pwd] = line.split('===');
            return { email: email.trim(), pwd: pwd.trim() };
        });

        const DB_KEY = 'zlib_pro_state';
        let currentPage = 1;
        const itemsPerPage = 5;

        function getAppState() {
            const today = new Date().toDateString();
            let state = JSON.parse(localStorage.getItem(DB_KEY) || 'null');
            if (!state || state.date !== today) {
                state = { date: today, history: [] };
                localStorage.setItem(DB_KEY, JSON.stringify(state));
            }
            return state;
        }

        function saveState(state) {
            localStorage.setItem(DB_KEY, JSON.stringify(state));
        }

        function handleNext() {
            const state = getAppState();
            const usedIndexes = state.history.map(h => h.idx);
            const available = ACCOUNTS_DATA.map((_, i) => i).filter(i => !usedIndexes.includes(i));

            if (available.length === 0) {
                alert("今日所有账号额度已试完，请明日再来！");
                return;
            }

            const nextIdx = available[Math.floor(Math.random() * available.length)];
            const record = {
                idx: nextIdx,
                time: new Date().toLocaleTimeString('zh-CN', { hour12: false })
            };

            state.history.push(record);
            saveState(state);
            renderAccount(nextIdx);
        }

        function renderAccount(index) {
            document.getElementById('email-val').innerText = ACCOUNTS_DATA[index].email;
            document.getElementById('pwd-val').innerText = ACCOUNTS_DATA[index].pwd;
        }

        function openHistory() {
            currentPage = 1;
            renderHistoryList();
            document.getElementById('modalOverlay').style.display = 'flex';
        }

        function closeHistory() {
            document.getElementById('modalOverlay').style.display = 'none';
        }

        function renderHistoryList() {
            const state = getAppState();
            const history = [...state.history].reverse();
            const listEl = document.getElementById('historyList');
            const pagEl = document.getElementById('pagination');
            
            listEl.innerHTML = '';
            pagEl.innerHTML = '';

            if (history.length === 0) {
                listEl.innerHTML = '<div style="text-align:center; color:#86868b; padding:40px;">尚未获取任何账号</div>';
                return;
            }

            const total = history.length;
            const usePag = total > itemsPerPage;
            const start = (currentPage - 1) * itemsPerPage;
            const pageData = history.slice(start, start + itemsPerPage);

            pageData.forEach(item => {
                const acc = ACCOUNTS_DATA[item.idx];
                const div = document.createElement('div');
                div.className = 'history-item';
                div.innerHTML = `
                    <div style="font-weight:700; color:#000;">${acc.email}</div>
                    <div style="font-family:monospace; color:#444;">${acc.pwd}</div>
                    <div class="time-tag">${item.time}</div>
                `;
                listEl.appendChild(div);
            });

            if (usePag) {
                const totalPages = Math.ceil(total / itemsPerPage);
                pagEl.innerHTML = `
                    <button class="page-btn btn" ${currentPage === 1 ? 'disabled' : ''} onclick="flipPage(-1)">上一页</button>
                    <span style="font-size:12px; font-weight:600;">${currentPage} / ${totalPages}</span>
                    <button class="page-btn btn" ${currentPage === totalPages ? 'disabled' : ''} onclick="flipPage(1)">下一页</button>
                `;
            }
        }

        function flipPage(step) {
            currentPage += step;
            renderHistoryList();
        }

        function copyText(id) {
            const val = document.getElementById(id).innerText;
            if (val.includes('准备') || val.includes('***')) return;
            
            const tmp = document.createElement('textarea');
            tmp.value = val;
            document.body.appendChild(tmp);
            tmp.select();
            document.execCommand('copy');
            document.body.removeChild(tmp);

            const toast = document.getElementById('toast');
            toast.style.opacity = '1';
            setTimeout(() => toast.style.opacity = '0', 1500);
        }

        window.onload = () => {
            const state = getAppState();
            if (state.history.length > 0) {
                renderAccount(state.history[state.history.length - 1].idx);
            } else {
                handleNext();
            }
        };
    </script>
</body>
</html>